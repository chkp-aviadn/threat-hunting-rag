# Threat Hunting RAG System - Example Environment Configuration
# Copy this file to `.env` and adjust values as needed for production.

# API configuration
API_KEY=demo-key-12345
PORT=8000
HOST=127.0.0.1

# Embeddings & Models
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_CACHE_DIR=cache/embeddings

# Business logic
BUSINESS_HOURS_START=8
BUSINESS_HOURS_END=18
TIMEZONE=UTC

# Vector index
VECTOR_COLLECTION_NAME=threat_hunting_emails
CHROMA_DB_PATH=data/chroma

# Optional Redis (set REDIS_ENABLED=true and provide REDIS_URL to enable session cache)
REDIS_ENABLED=false
REDIS_URL=redis://localhost:6379/0

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/app.log

# Security / rate limiting (adjust for production scale)
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60

# Feature extractor caching
ENABLE_DOMAIN_CACHE=true
DOMAIN_CACHE_TTL=3600
MAX_CACHE_SIZE=1000

# Placeholder for future LLM integration
LLM_PROVIDER=none
LLM_API_KEY=
################################################################################
# Threat Hunting RAG System - Example Environment Configuration
# Copy this file to `.env` and modify values as needed.
# NOTE: Do NOT commit real secrets (API keys, tokens) to version control.
################################################################################

###############################################################################
# MODEL & EMBEDDINGS
###############################################################################
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
MODEL_CACHE_DIR=src/shared/cache/models_cache/

###############################################################################
# DATA PATHS
###############################################################################
VECTOR_DB_PATH=data/chroma
EMAIL_DATASET_PATH=data/emails.csv

###############################################################################
# CACHE DIRECTORIES (Persistent & Application)
###############################################################################
EMBEDDING_CACHE_DIR=src/shared/cache/embeddings_cache/
QUERY_CACHE_DIR=src/shared/cache/query_cache/
DOMAIN_CACHE_DIR=cache/application/domain_analysis/
THREAT_FEATURES_CACHE_DIR=cache/application/threat_features/
SIMILARITY_CACHE_DIR=cache/application/similarity_scores/
TEMP_CACHE_DIR=cache/temp/
SESSION_CACHE_DIR=cache/temp/user_sessions/

###############################################################################
# PERFORMANCE & SCORING
###############################################################################
PHISHING_THRESHOLD=0.7
MAX_RESULTS=10
BATCH_SIZE=32
CACHE_TTL_SECONDS=3600
MAX_CACHE_SIZE=1000

###############################################################################
# API SERVER SETTINGS
###############################################################################
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_KEY=demo-key-12345        # Replace for production
ENABLE_API_AUTH=true
CORS_ORIGINS=http://localhost:3000,https://your-domain.com

###############################################################################
# RATE LIMITING
###############################################################################
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=20
CLI_RATE_LIMIT_PER_MINUTE=60

###############################################################################
# LOGGING
###############################################################################
LOG_LEVEL=INFO
# LOG_FILE=logs/app.log        # Uncomment to enable file logging
VERBOSE_LOGGING=false
DEBUG=false

###############################################################################
# SECURITY CONTROLS
###############################################################################
REQUIRE_ADMIN_CONFIRMATION=false
ENABLE_AUDIT_LOGGING=true
AUDIT_LOG_PATH=logs/security_audit.log
ENABLE_INPUT_SANITIZATION=true
MAX_QUERY_LENGTH=500
ALLOWED_DATA_DIRS=data/,cache/,models/

###############################################################################
# REDIS (OPTIONAL for distributed sessions/cache)
###############################################################################
REDIS_ENABLED=false
REDIS_URL=redis://localhost:6379/0

###############################################################################
# LLM INTEGRATION (OPTIONAL)
###############################################################################
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4o-mini

###############################################################################
# OVERRIDE DIRECTORIES ONLY IF RELOCATING
###############################################################################
# (Defaults already match internal config; change if customizing layout.)
# DOMAIN_CACHE_DIR=cache/application/domain_analysis/
# THREAT_FEATURES_CACHE_DIR=cache/application/threat_features/
# SIMILARITY_CACHE_DIR=cache/application/similarity_scores/
# TEMP_CACHE_DIR=cache/temp/
# SESSION_CACHE_DIR=cache/temp/user_sessions/
